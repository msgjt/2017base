<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	template="templates/template.xhtml">

	<ui:define name="content">

		<h:form id="form">
			<p:growl id="msgs" showDetail="true" />


			<p:panelGrid columns="1">
				<p:commandLink styleClass="buttonLink"
					update=":mainForm:form:addUser"
					oncomplete="PF('addUserDialog').show()"
					title="#{msg['op.addNewUser']}" value="#{msg['op.addNewUser']}">
				</p:commandLink>
			</p:panelGrid>

			<p:dialog header="#{msg['managecompanies.popUp']}"
				widgetVar="addUserDialog" showEffect="blind" hideEffect="explode"
				resizable="false" height="350" width="500">

				<p:outputPanel id="addUser" style="text-align:center;">


					<h:panelGrid columns="2">

						<p:outputLabel for="firstName" value="#{msg['user.firstName']}"></p:outputLabel>
						<p:inputText id="firstName" value="#{userBean.firstName}">
							<f:validator validatorId="firstNameValidator" />
						</p:inputText>

						<p:outputLabel for="lastName" value="#{msg['user.lastName']}"></p:outputLabel>
						<p:inputText id="lastName" value="#{userBean.lastName}">
							<f:validator validatorId="lastNameValidator" />
						</p:inputText>

						<p:outputLabel for="userName" value="#{msg['user.userName']}"></p:outputLabel>
						<p:inputText id="userName" value="#{userBean.userName}">
							<f:validator validatorId="userValidator" />
						</p:inputText>

						<p:outputLabel for="password1" value="#{msg['user.password']}"></p:outputLabel>
						<p:password id="password1" value="#{userBean.password1}">
							<f:validator validatorId="newUserPasswordValidator" />
						</p:password>

						<p:outputLabel for="password2"
							value="#{msg['user.confirmPassword']}"></p:outputLabel>
						<p:password id="password2" value="#{userBean.password2}">
							<f:validator validatorId="newUserPasswordValidator" />
						</p:password>

						<p:outputLabel for="type" value="#{msg['user.userType']}"></p:outputLabel>
						<p:selectOneMenu id="type" value="#{userBean.type}">
							<f:selectItems value="#{userBean.userTypes}" />
						</p:selectOneMenu>

						<p:outputLabel for="company" value="#{msg['company.company']}"></p:outputLabel>
						<p:selectOneMenu id="company" value="#{userBean.company}"
							converter="companyConverter">
							<f:selectItems value="#{userBean.companyList}" var="company"
								itemLabel="#{company.companyName}" itemValue="#{company}" />
						</p:selectOneMenu>

						<h:commandButton value="#{msg['op.insert']}"
							action="#{userBean.processInsert}"></h:commandButton>


					</h:panelGrid>

				</p:outputPanel>
			</p:dialog>



			<p:dataTable value="#{userBean.userList}" var="user" editable="true">



				<f:facet name="header">
					<h:outputText value="#{msg['user.userTable']}"></h:outputText>
				</f:facet>



				<p:ajax event="rowEdit" listener="#{userBean.onRowEdit}"
					update="#{p:component('msgs')}" />
				<p:ajax event="rowEditCancel" listener="#{userBean.onRowCancel}"
					update="#{p:component('msgs')}" />

				<p:column headerText="#{msg['user.userName']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.userName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{user.userName}" validator="userValidator" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{msg['user.firstName']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.firstName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{user.firstName}"
								validator="firstNameValidator" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{msg['user.lastName']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.lastName}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText value="#{user.lastName}"
								validator="lastNameValidator" />
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{msg['user.userType']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.type}" />
						</f:facet>
						<f:facet name="input">
							<p:selectOneMenu id="type" value="#{user.type}">
								<f:selectItems value="#{userBean.userTypes}" />
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{msg['company.company']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.company.companyName}" />
						</f:facet>
						<f:facet name="input">
							<p:selectOneMenu id="company" value="#{user.company}"
								converter="companyConverter">
								<f:selectItems value="#{userBean.companyList}" var="company"
									itemLabel="#{company.companyName}" itemValue="#{company}" />
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column headerText="#{msg['user.status']}">
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{user.status}" />
						</f:facet>
						<f:facet name="input">
							<p:selectOneMenu id="status" value="#{user.status}">
								<f:selectItem itemLabel="true" itemValue="#{true}" />
								<f:selectItem itemLabel="false" itemValue="#{false}" />
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				</p:column>

				<p:column style="width:32px">
					<p:rowEditor />
				</p:column>



			</p:dataTable>

		</h:form>

	</ui:define>

</ui:composition>
