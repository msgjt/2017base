<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	template="templates/template.xhtml">

	<ui:define name="content">


		<h:form id="form">

			<p:growl id="msg" autoUpdate="true" showDetail="true" />

			<p:panelGrid columns="1">

				<p:panelGrid columns="1">

					<p:outputLabel for="companyList" value="#{msg['company.company']}"></p:outputLabel>
					<p:selectOneMenu id="companyList"
						value="#{crewAssignmentBean.company}" converter="companyConverter">
						<f:selectItem noSelectionOption="true"
							itemLabel="#{msg['crew.selectCompany']}">
						</f:selectItem>
						<f:selectItems value="#{crewAssignmentBean.companyList}"
							var="company" itemLabel="#{company.companyName}"
							itemValue="#{company}" />
						<p:ajax event="change"
							listener="#{crewAssignmentBean.loadFlightsAndUsers}"
							update="#{p:component('flight')}"></p:ajax>
					</p:selectOneMenu>


					<p:outputLabel for="flight" value="#{msg['flight.flight']}"></p:outputLabel>
					<p:selectOneMenu id="flight" value="#{crewAssignmentBean.flight}"
						converter="flightConverter">
						<f:selectItem noSelectionOption="true"
							itemLabel="#{msg['crew.selectFlight']}">
						</f:selectItem>
						<f:selectItems value="#{crewAssignmentBean.flightList}"
							var="flight"
							itemLabel="#{flight.flightId}. #{flight.airport1.airportName} - #{flight.airport2.airportName}"
							itemValue="#{flight}" />
						<p:ajax event="change"
							update="#{p:component('userMenuAdd')} #{p:component('userMenuRemove')}"></p:ajax>
					</p:selectOneMenu>
					<h:outputText id="flightinfo"
						value="#{crewAssignmentBean.flightInfo}"></h:outputText>
				</p:panelGrid>

				<p:panelGrid columns="3">
					<p:panelGrid columns="1">
						<p:outputLabel for="userMenuAdd"
							value="#{msg['crew.unassignedCrew']}"></p:outputLabel>
						<p:selectManyMenu id="userMenuAdd"
							value="#{crewAssignmentBean.selectedUsersAdd}"
							converter="userConverter" var="u" filter="true"
							filterMatchMode="contains" showCheckbox="true">
							<f:selectItems value="#{crewAssignmentBean.userList}" var="user"
								itemLabel="#{user.userName}" itemValue="#{user}"
								itemDisabled="#{user.getFlights().contains(crewAssignmentBean.flight)}" />
							<p:column>
								<h:outputText value="#{u.userName}"></h:outputText>
							</p:column>
						</p:selectManyMenu>
					</p:panelGrid>

					<p:panelGrid columns="1">

						<p:commandButton value="&#8680;"
							actionListener="#{crewAssignmentBean.processAssign}"
							update="#{p:component('userMenuAdd')} #{p:component('userMenuRemove')}">
						</p:commandButton>

						<p:commandButton value="&#8678;"
							actionListener="#{crewAssignmentBean.processRemove}"
							update="#{p:component('userMenuAdd')} #{p:component('userMenuRemove')}">
						</p:commandButton>
					</p:panelGrid>

					<p:panelGrid columns="1">
						<p:outputLabel for="userMenuRemove"
							value="#{msg['crew.assignedCrew']}"></p:outputLabel>
						<p:selectManyMenu id="userMenuRemove"
							value="#{crewAssignmentBean.selectedUsersRemove}"
							converter="userConverter" var="u" filter="true"
							filterMatchMode="contains" showCheckbox="true">
							<f:selectItems value="#{crewAssignmentBean.userList}" var="user"
								itemLabel="#{user.userName}" itemValue="#{user}"
								itemDisabled="#{!user.getFlights().contains(crewAssignmentBean.flight)}" />
							<p:column>
								<h:outputText value="#{u.userName}"></h:outputText>
							</p:column>
						</p:selectManyMenu>
					</p:panelGrid>

				</p:panelGrid>

			</p:panelGrid>

		</h:form>

	</ui:define>

</ui:composition>
