<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	template="templates/template.xhtml">

	<ui:define name="content">

		<p:growl id="growl" showDetail="true" sticky="true" autoUpdate="true" />
		<h:form>
			<h:outputText value="#{msg['reports.noAccess']}" style="color:red"
				rendered="#{!reportsBean.mRendered}" />

			<p:tabView activeIndex="0" rendered="#{reportsBean.mRendered}">
				<p:tab title="#{msg['reports.company']}">
					<h:panelGrid columns="4">
						<p:outputLabel value="#{msg['reports.company']}:" for="comp" />
						<p:selectOneMenu id="comp" value="#{reportsBean.selectedCompany}"
							converter="companyConverter">
							<f:selectItems value="#{reportsBean.companyList}" var="company"
								itemLabel="#{company.companyName}" itemValue="#{company}" />
						</p:selectOneMenu>
						<p:outputLabel for="fromDate"
							value="#{msg['reports.startDate']}:dd/MM/yy" />
						<p:calendar id="fromDate" value="#{reportsBean.fromDate}"
							readonlyInput="true" pattern="dd/MM/yy" />

						<p:outputLabel value="" />
						<p:commandButton value="#{msg['reports.generateReport']}"
							actionListener="#{reportsBean.companyReport}"
							icon="ui-icon-check" update="@([id$=cGroup])" />
						<p:outputLabel for="toDate"
							value="#{msg['reports.endDate']}:dd/MM/yy" />
						<p:calendar id="toDate" value="#{reportsBean.toDate}"
							readonlyInput="true" pattern="dd/MM/yy" />
					</h:panelGrid>
					<p></p>
					<h:panelGroup id="cGroup">
						<h:form rendered="#{reportsBean.cRendered}">
							<p:panelGrid columns="2" layout="grid">
								<f:facet name="header">
									<h:outputText
										value="#{msg['reports.company']} #{reportsBean.selectedCompany.companyName}" />
								</f:facet>
								<h:outputText
									value="  #{msg['reports.address']}: #{reportsBean.selectedCompany.address}" />
								<h:outputText
									value="  #{msg['reports.tel']}: #{reportsBean.selectedCompany.phone}" />

								<h:outputText
									value="  #{msg['reports.nrFlights']}: (#{reportsBean.fromDateString} - #{reportsBean.toDateString}): #{reportsBean.nrFlights}" />
								<h:outputText
									value="  #{msg['reports.nrTotalFlights']}: #{reportsBean.totalFlights}" />

								<h:outputText
									value="  #{msg['reports.nrEmployees']}: #{reportsBean.nrEmployees}" />
								<h:outputText
									value="  #{msg['reports.planeCount']}: #{reportsBean.nrPlanes}" />
							</p:panelGrid>

							<center>
								<p:dataTable var="flights" value="#{reportsBean.flightList}"
									emptyMessage="#{msg['reports.emptyMessage']}">
									<f:facet name="header">
										<h:outputText
											value="#{msg['reports.flightsFrom']} #{reportsBean.fromDateString} - #{reportsBean.toDateString}" />
									</f:facet>
									<p:column headerText="#{msg['reports.flightId']}">
										<h:outputText value="#{flights.flightId}" />
									</p:column>
									<p:column headerText="#{msg['reports.departure']}">
										<h:outputText value="#{flights.airport1.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrival']}">
										<h:outputText value="#{flights.airport2.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.departureTime']}">
										<h:outputText value="#{flights.startDate}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrivalTime']}">
										<h:outputText value="#{flights.endDate}" />
									</p:column>
									<p:column headerText="#{msg['reports.planeId']}">
										<h:outputText value="#{flights.plane.planeId}" />
									</p:column>
									<p:column headerText="#{msg['reports.planeModel']}">
										<h:outputText value="#{flights.plane.model}" />
									</p:column>
								</p:dataTable>
							</center>
						</h:form>
					</h:panelGroup>
				</p:tab>

				<p:tab title="#{msg['reports.planes']}">
					<h:panelGrid columns="5">
						<p:outputLabel value="#{msg['reports.company']}:" for="comp2" />
						<p:selectOneMenu id="comp2"
							value="#{reportsBean.selectedCompany2}"
							converter="companyConverter"
							valueChangeListener="#{reportsBean.changePlaneList}">
							<f:selectItems value="#{reportsBean.companyList}" var="company2"
								itemLabel="#{company2.companyName}" itemValue="#{company2}" />
							<f:ajax event="change" execute="@form" render="pList" />
						</p:selectOneMenu>

						<p:outputLabel value="#{msg['reports.planes']}:" for="pList" />

						<p:selectOneMenu id="pList"
							value="#{reportsBean.selectedCompanyPlanes}"
							converter="planeConverter">
							<f:selectItems id="planeItems" value="#{reportsBean.planesList}"
								var="planes" itemLabel="#{planes.model}" itemValue="#{planes}" />
						</p:selectOneMenu>

						<p:commandButton value="#{msg['reports.generateReport']}"
							actionListener="#{reportsBean.planeReport}" icon="ui-icon-check"
							update="@([id$=pGroup])" />
					</h:panelGrid>
					<h:panelGroup id="pGroup">
						<h:form rendered="#{reportsBean.pRendered}">
							<p:panelGrid columns="2" layout="grid">
								<f:facet name="header">
									<h:outputText
										value="#{msg['reports.company']} #{reportsBean.selectedCompany2.companyName}" />
								</f:facet>
								<h:outputText
									value="  #{msg['reports.planeId']}: #{reportsBean.selectedPlane.planeId}" />
								<h:outputText
									value="  #{msg['reports.capacity']}: #{reportsBean.selectedPlane.capacity}" />

								<h:outputText
									value="  #{msg['reports.planeModel']}: #{reportsBean.selectedPlane.model}" />
								<h:outputText
									value="  #{msg['reports.status']}: #{msg['reports.enabled']}"
									rendered="#{reportsBean.selectedPlane.status}" />
								<h:outputText
									value="  #{msg['reports.status']}: #{msg['reports.disabled']}"
									rendered="#{!reportsBean.selectedPlane.status}" />

							</p:panelGrid>
							<center>
								<p:dataTable var="flights" value="#{reportsBean.flightList}"
									emptyMessage="#{msg['reports.emptyMessage']}">
									<f:facet name="header">
										<h:outputText
											value="#{msg['reports.allFlights']} (#{reportsBean.totalFlights}): #{reportsBean.selectedPlane.model}" />
									</f:facet>
									<p:column headerText="#{msg['reports.flightId']}">
										<h:outputText value="#{flights.flightId}" />
									</p:column>
									<p:column headerText="#{msg['reports.departure']}">
										<h:outputText value="#{flights.airport1.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrival']}">
										<h:outputText value="#{flights.airport2.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.departureTime']}">
										<h:outputText value="#{flights.startDate}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrivalTime']}">
										<h:outputText value="#{flights.endDate}" />
									</p:column>
								</p:dataTable>
							</center>
						</h:form>
					</h:panelGroup>
				</p:tab>

				<p:tab title="#{msg['reports.employees']}">
					<h:panelGrid columns="5">
						<p:outputLabel value="#{msg['reports.company']}:" for="comp3" />
						<p:selectOneMenu id="comp3"
							value="#{reportsBean.selectedCompany3}"
							converter="companyConverter"
							valueChangeListener="#{reportsBean.changeEmployeeList}">
							<f:selectItems value="#{reportsBean.companyList}" var="company3"
								itemLabel="#{company3.companyName}" itemValue="#{company3}" />
							<f:ajax event="change" execute="@form" render="eList" />
						</p:selectOneMenu>
						<p:outputLabel value="#{msg['reports.employees']}:" for="eList" />
						<p:selectOneMenu id="eList"
							value="#{reportsBean.selectedEmployee}" converter="userConverter"
							required="false">
							<f:selectItems id="userItems" value="#{reportsBean.employeeList}"
								var="user" itemLabel="#{user.firstName} #{user.lastName}"
								itemValue="#{user}" />
						</p:selectOneMenu>
						<p:commandButton value="#{msg['reports.generateReport']}"
							actionListener="#{reportsBean.employeeReport}"
							icon="ui-icon-check" update="@([id$=eGroup])" />
					</h:panelGrid>
					<h:panelGroup id="eGroup">
						<h:form rendered="#{reportsBean.eRendered}">
							<p:panelGrid columns="2" layout="grid">
								<f:facet name="header">
									<h:outputText
										value="#{msg['reports.employee']}: #{reportsBean.selectedEmployee.firstName} #{reportsBean.selectedEmployee.lastName}" />
								</f:facet>
								<h:outputText
									value="  #{msg['reports.name']}: #{reportsBean.selectedEmployee.firstName} #{reportsBean.selectedEmployee.lastName}" />
								<h:outputText
									value="  #{msg['reports.accessLevel']}: #{reportsBean.selectedEmployee.type}" />

								<h:outputText
									value="  #{msg['reports.totalFlights']}: #{reportsBean.totalFlights}" />
								<h:outputText
									value="  #{msg['reports.status']}: #{msg['reports.enabled']}"
									rendered="#{reportsBean.selectedEmployee.status}" />
								<h:outputText
									value="  #{msg['reports.status']}: #{msg['reports.disabled']}"
									rendered="#{!reportsBean.selectedEmployee.status}" />
							</p:panelGrid>
							<center>
								<p:dataTable var="flights" value="#{reportsBean.flightList}"
									emptyMessage="#{msg['reports.emptyMessage']}">
									<f:facet name="header">
										<h:outputText
											value="#{msg['reports.allFlights']} (#{reportsBean.totalFlights})" />
									</f:facet>
									<p:column headerText="#{msg['reports.flightId']}">
										<h:outputText value="#{flights.flightId}" />
									</p:column>
									<p:column headerText="#{msg['reports.departure']}">
										<h:outputText value="#{flights.airport1.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrival']}">
										<h:outputText value="#{flights.airport2.airportName}" />
									</p:column>
									<p:column headerText="#{msg['reports.departureTime']}">
										<h:outputText value="#{flights.startDate}" />
									</p:column>
									<p:column headerText="#{msg['reports.arrivalTime']}">
										<h:outputText value="#{flights.endDate}" />
									</p:column>
									<p:column headerText="#{msg['reports.planeId']}">
										<h:outputText value="#{flights.plane.planeId}" />
									</p:column>
									<p:column headerText="#{msg['reports.planeModel']}">
										<h:outputText value="#{flights.plane.model}" />
									</p:column>
								</p:dataTable>
							</center>
						</h:form>
					</h:panelGroup>
				</p:tab>
			</p:tabView>
		</h:form>

	</ui:define>

</ui:composition>
